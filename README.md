Задание №4
Разработать ассемблер и интерпретатор для учебной виртуальной машины
(УВМ). Система команд УВМ представлена далее.
Для ассемблера необходимо разработать читаемое представление команд
УВМ. Ассемблер принимает на вход файл с текстом исходной программы, путь к
которой задается из командной строки. Результатом работы ассемблера является
бинарный файл в виде последовательности байт, путь к которому задается из
командной строки. Дополнительный ключ командной строки задает путь к файлулогу, в котором хранятся ассемблированные инструкции в духе списков
“ключ=значение”, как в приведенных далее тестах.
Интерпретатор принимает на вход бинарный файл, выполняет команды УВМ
и сохраняет в файле-результате значения из диапазона памяти УВМ. Диапазон
также указывается из командной строки.
97
Форматом для файла-лога и файла-результата является yaml.
Необходимо реализовать приведенные тесты для всех команд, а также
написать и отладить тестовую программу.
Загрузка константы
A B C
Биты 0—7 Биты 8—23 Биты 24—34
97 Адрес Константа
Размер команды: 5 байт. Операнд: поле C. Результат: значение в памяти по
адресу, которым является поле B.
Тест (A=97, B=258, C=82):
0x61, 0x02, 0x01, 0x52, 0x00
Чтение значения из памяти
A B C
Биты 0—7 Биты 8—23 Биты 24—39
10 Адрес Адрес
Размер команды: 5 байт. Операнд: значение в памяти по адресу, которым
является значение в памяти по адресу, которым является поле C. Результат:
значение в памяти по адресу, которым является поле B.
Тест (A=10, B=975, C=908):
0x0A, 0xCF, 0x03, 0x8C, 0x03
Запись значения в память
A B C D
Биты 0—7 Биты 8—20 Биты 21—36 Биты 37—52
101 Смещение Адрес Адрес
Размер команды: 7 байт. Операнд: значение в памяти по адресу, которым
является поле C. Результат: значение в памяти по адресу, которым является сумма
98
адреса (значение в памяти по адресу, которым является поле D) и смещения (поле
B).
Тест (A=101, B=308, C=981, D=487):
0x65, 0x34, 0xA1, 0x7A, 0xE0, 0x3C, 0x00
Бинарная операция: вычитание
A B C D E
Биты 0—7 Биты 8—23 Биты 24—36 Биты 37—52 Биты 53—68
121 Адрес Смещение Адрес Адрес
Размер команды: 9 байт. Первый операнд: значение в памяти по адресу,
которым является поле E. Второй операнд: значение в памяти по адресу, которым
является поле D. Результат: значение в памяти по адресу, которым является сумма
адреса (значение в памяти по адресу, которым является поле B) и смещения (поле
C).
Тест (A=121, B=106, C=425, D=151, E=50):
0x79, 0x6A, 0x00, 0xA9, 0xE1, 0x12, 0x40, 0x06, 0x00
Тестовая программа
Выполнить поэлементно операцию вычитание над вектором длины 8 и числом
14. Результат записать в новый вектор.



как запустить
python script.py --input program_vec.txt --bin program.bin --log log.yaml
python script2.py --bin program.bin --out result.yaml --range 0 20
coverage run --source=script -m unittest test_script.py 
coverage report
